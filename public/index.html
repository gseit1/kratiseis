<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyShop | Discover & Reserve</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.5/font/bootstrap-icons.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" rel="stylesheet">
    <link rel="stylesheet" href="../styles/customer.css">

        <link rel="stylesheet" href="styles/customer.css">
        <link rel="stylesheet" href="styles/hero.css">
        <link rel="stylesheet" href="styles/navbar.css">
        <link rel="stylesheet" href="styles/footer.css">
        <link rel="stylesheet" href="styles/testimonials.css">
        <link rel="stylesheet" href="styles/cities.css">
        <link rel="stylesheet" href="styles/cta.css">
        <link rel="stylesheet" href="styles/newsletter.css">
        <style>
          /* Hero section compact and modern */
          .hero-outbox { min-height:320px; padding:32px 0 0 0; }
          .hero-img { max-height:180px; object-fit:cover; border-radius:18px; box-shadow:0 4px 24px #7873f522; }
          .categories { background:rgba(255,255,255,0.07); border-radius:18px; padding:1.2rem 1.2rem 1.1rem 1.2rem; box-shadow:0 2px 12px #7873f511; }
          .hero-title { font-size:1.3rem; font-weight:700; color:#ff6ec4; text-align:left; }
          .city-select, .category-select { width:100%; font-size:1.08rem; border-radius:0; }
          @media (max-width: 768px) {
            .hero-outbox .container-fluid { flex-direction:column; gap:1.5rem; }
            .hero-img { max-width:100%; }
          }
        </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top shadow-lg" id="navbar" style="background: rgba(30, 30, 40, 0.85); backdrop-filter: blur(8px); box-shadow: 0 4px 10px rgba(0,0,0,0.15);">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html" style="font-weight:bold;font-size:1.5rem;color:#fff;">
                <i class="bi bi-shop"></i> MyShop
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="index.html" style="color:#fff;font-weight:500;transition:color 0.3s;">
                            <i class="bi bi-house-door"></i> Αρχική
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="searchShops.html" style="color:#fff;font-weight:500;transition:color 0.3s;">
                            <i class="bi bi-shop-window"></i> Μαγαζιά
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="application.html" style="color:#fff;font-weight:500;transition:color 0.3s;">
                            <i class="bi bi-pencil-square"></i> Κάνε αίτηση
                        </a>
                    </li>
                    <li class="nav-item" id="registerLoginNavItem">
                        <a class="nav-link" href="registerLogin.html" style="color:#fff;font-weight:500;transition:color 0.3s;">
                            <i class="bi bi-person-plus"></i> Εγγραφή/Σύνδεση
                        </a>
                    </li>
                    <li class="nav-item dropdown d-none" id="profileDropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="profileDropdownMenu" role="button" data-bs-toggle="dropdown" aria-expanded="false" style="color:#fff;font-weight:500;">
                            <i class="bi bi-person-circle"></i> Ο λογαριασμός μου
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileDropdownMenu" style="background:rgba(30,30,40,0.97);">
                            <li>
                                <a class="dropdown-item" href="profile.html" style="color:#fff;">
                                    <i class="bi bi-person"></i> View Profile
                                </a>
                            </li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li>
                                <a class="dropdown-item" href="#" id="logoutBtn" style="color:#fff;">
                                    <i class="bi bi-box-arrow-right"></i> Αποσύνδεση
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <section class="hero-outbox position-relative" id="heroSection">
      <!-- Animated Sparkles SVG Background -->
      <div class="hero-sparkles-bg position-absolute top-0 start-0 w-100 h-100" aria-hidden="true" style="pointer-events:none;z-index:0;"></div>
      <div class="container-fluid d-flex align-items-center justify-content-center flex-column flex-md-row" style="gap:2.5rem;min-height:180px;z-index:1;position:relative;">
        <div class="row w-100 align-items-center justify-content-center flex-column flex-md-row" style="gap:0;">
          <!-- Left: Text and Badges -->
          <div class="col-12 col-md-6 d-flex flex-column align-items-start justify-content-center" style="gap:1.2rem;">
            <h1 class="glitch mb-1 hero-title d-flex align-items-center" data-text="Unlock Your City" style="font-size:2.5rem;font-weight:900;color:#ff6ec4;letter-spacing:0.01em;text-shadow:0 4px 16px #0004;line-height:1.18;">
              <span aria-hidden="true" style="font-size:2.1rem;margin-right:0.5rem;">✨</span>Ξεκλείδωσε την πόλη σου
            </h1>
            <p class="typing-subtitle mb-2" style="font-size:1.18rem;color:#eaeaea;line-height:1.6;font-weight:500;">Βρες και κάνε κράτηση στα καλύτερα εστιατόρια, καφέ και μπαρ στην περιοχή σου, online.</p>
            <div class="category-badges d-flex flex-wrap mb-2" style="gap:1.1rem 1.5rem;">
              <span class="category-badge" tabindex="0" aria-label="Restaurants"><i class="bi bi-egg-fried"></i> Restaurants <span class="badge">42</span></span>
              <span class="category-badge" tabindex="0" aria-label="Cafés"><i class="bi bi-cup-hot"></i> Cafés <span class="badge">28</span></span>
              <span class="category-badge" tabindex="0" aria-label="Bars"><i class="bi bi-music-note-beamed"></i> Bars <span class="badge">35</span></span>
              <span class="category-badge" tabindex="0" aria-label="Pizza"><i class="bi bi-pizza"></i> Pizza <span class="badge">18</span></span>
            </div>
          </div>
          <!-- Right: Search Card -->
          <div class="col-12 col-md-6 d-flex align-items-center justify-content-center mt-4 mt-md-0" style="min-height:440px;">
            <div class="hero-search-card w-100 glassy-card" style="max-width:420px;">
              <h2 class="fw-bold mb-2" style="font-size:1.35rem;line-height:1.3;">Ανακάλυψε τώρα <span style="font-size:1.2rem;">🔎</span></h2>
              <form class="w-100 mb-2" role="search" aria-label="Search shops by city and category" onsubmit="return false;">
                <div class="input-group mb-2 hero-search-group">
                  <span class="input-group-text bg-transparent border-0"><i class="bi bi-geo-alt"></i></span>
                  <select id="cityDropdown" class="form-select hero-search-input city-select" aria-label="Επιλογή πόλης">
                    <option value="">-- πόλη --</option>
                  </select>
                </div>
                <div class="input-group mb-2 hero-search-group">
                  <span class="input-group-text bg-transparent border-0"><i class="bi bi-tags"></i></span>
                  <select id="categoryDropdown" class="form-select hero-search-input category-select" aria-label="Επιλογή κατηγορίας">
                    <option value="">-- κατηγορία --</option>
                  </select>
                </div>
                <div class="d-flex align-items-center gap-2 mb-2">
                  <div id="cityIconPreview"></div>
                  <div id="categoryIconPreview"></div>
                </div>
                <button id="viewAllBtn" class="hero-search-btn mt-2 w-100" >Αναζήτηση</button>
              </form>
            </div>
          </div>
        </div>
      </div>
      <div class="scroll-indicator position-absolute start-50 translate-middle-x" style="bottom:12px;z-index:2;">
        <span class="scroll-arrow" aria-hidden="true" style="display:block;width:32px;height:32px;animation:scroll-bounce 1.5s infinite;">
          <svg width="32" height="32" viewBox="0 0 32 32"><path d="M16 8v16M16 24l-6-6M16 24l6-6" stroke="#fff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg>
        </span>
      </div>
    </section>
   
      
            
      
    <!-- How it works section removed for a cleaner, more direct experience -->

    <section class="shop-categories py-5" id="shops">
        <div class="container">
    
            <!-- Category 1: Specific Shop IDs -->
            <div class="category-row mb-4">
                <h3 class="mb-3"><i class="bi bi-stars"></i> Προτεινόμενα</h3>
                <div id="selectedShopsContainer" class="scrollable-row d-flex overflow-auto">
                    <!-- JavaScript will populate -->
                </div>
            </div>
    
            <!-- Category 2: Shops in Athens -->
            <div class="category-row mb-4">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h3 class="mb-0"><i class="bi bi-geo-alt"></i> Καταστήματα Αθήνα</h3>
                    <button class="btn btn-outline-primary btn-sm" id="viewAllAthensBtn">View All</button>
                </div>
                <div id="athensShopsContainer" class="scrollable-row d-flex overflow-auto"></div>
            </div>
    
            <!-- Category 3: Shops in Thessaloniki -->
            <div class="category-row mb-4">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h3 class="mb-0"><i class="bi bi-geo-alt"></i> Καταστήματα Θεσσαλονίκη</h3>
                    <button class="btn btn-outline-primary btn-sm" id="viewAllThessBtn">View All</button>
                </div>
                <div id="thessalonikiShopsContainer" class="scrollable-row d-flex overflow-auto"></div>
            </div>
        </div>
    </section>

    <!-- Latest & Top Rated Shops Section -->
    <section id="featuredShops" class="mt-3">
      <div class="container">
        <div class="row g-3 justify-content-center">
          <!-- Latest Shops Card -->
          <div class="col-12 col-md-6">
            <div class="latest-shop-card h-100 p-3" style="min-height:unset;">
              <div class="d-flex align-items-center justify-content-center mb-2">
                <span class="latest-shops-icon" style="font-size:1.5rem;color:#e74c3c;margin-right:8px;"><i class="bi bi-stars"></i></span>
                <h2 class="fw-bold mb-0" style="font-size:1.2rem;">Νέα Καταστήματα</h2>
              </div>
              <ul id="latestShopsList" class="latest-shop-list"></ul>
              <div class="d-flex justify-content-center mt-2">
                <a href="searchShops.html?sort=latest" class="see-all-link fw-bold" style="font-size:0.98rem;">See All</a>
              </div>
            </div>
          </div>
          <!-- Top Rated Shops Card -->
          <div class="col-12 col-md-6">
            <div class="latest-shop-card h-100 p-3" style="min-height:unset;">
              <div class="d-flex align-items-center justify-content-center mb-2">
                <span class="latest-shops-icon" style="font-size:1.5rem;color:#e67e22;margin-right:8px;"><i class="bi bi-trophy"></i></span>
                <h2 class="fw-bold mb-0" style="font-size:1.2rem;">Κορυφαία Βαθμολογία</h2>
              </div>
              <ul id="topRatedShopsList" class="latest-shop-list"></ul>
              <div class="d-flex justify-content-center mt-2">
                <a href="searchShops.html?sort=top" class="see-all-link fw-bold" style="font-size:0.98rem;">See All</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Homepage City Cards Section (dynamic) -->
    <section class="homepage-feature-cards city-explore-section" id="homepageCityCards">
      <div class="container position-relative" style="min-height:480px;">
        <div id="mainCityHero" class="main-city-hero mb-4" style="position:relative;min-height:420px;display:flex;align-items:end;justify-content:center;overflow:hidden;border-radius:32px;background:#181824;">
          <!-- JS will populate main city hero here -->
        </div>
        <div class="city-cards-carousel d-flex flex-row flex-nowrap justify-content-end align-items-end" id="cityCardsCarousel" style="gap:32px;position:absolute;right:0;bottom:0;z-index:2;padding:0 2vw 2vw 0;">
          <!-- JS will populate city nav cards here -->
        </div>
      </div>
    </section>

  
 <!--   <section id="gallery" class="w-full bg-white py-20 px-4 md:px-12 lg:px-32">
        <div class="text-center mb-12" data-aos="fade-up">
          <h2 class="text-4xl font-bold text-gray-800 mb-4">Gallery</h2>
          <p class="text-lg text-gray-600">Peek into the spaces you’ll love</p>
        </div>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4" data-aos="fade-up">
          <img src="index/aboutus.png" class="rounded-xl hover:scale-105 transition duration-300">
          <img src="index/hero.png" class="rounded-xl hover:scale-105 transition duration-300">
          <img src="index/img2.jpg" class="rounded-xl hover:scale-105 transition duration-300">
          <img src="index/outfit2.png" class="rounded-xl hover:scale-105 transition duration-300">
        </div>
      </section>
      -->
     
    
    
    
    
    <section class="cta text-center py-5 bg-primary text-light position-relative overflow-hidden">
        <div class="container position-relative z-index-1">
            <h2 class="cta-heading mb-4">Έτοιμος να Ανακαλύψεις το Επόμενο <br> Αγαπημένο σου Σημείο;</h2>
            <p class="cta-text mb-4">Κάνε εγγραφή τώρα και ξεκίνα την εξερεύνηση των καλύτερων τοποθεσιών κοντά σου!

            </p>
            <a href="registerLogin.html" class="btn btn-light btn-lg px-5 py-3 shadow">Ξεκίνα τώρα</a>
        </div>
        <div class="cta-overlay position-absolute top-0 start-0 w-100 h-100" style="background: rgba(0, 0, 0, 0.5);"></div>
        <div class="cta-background position-absolute top-0 start-0 w-100 h-100" style="background: url('index/cta-bg.jpg') no-repeat center center/cover;"></div>
    </section>

    <section class="newsletter text-center">
        <div class="container">
            <h2>Μείνε Ενημερωμένος
            </h2>
            <p>Γράψου στο newsletter μας και μην χάσεις ποτέ ένα υπέροχο μέρος.

            </p>
            <form class="row g-3 justify-content-center">
                <div class="col-md-4">
                    <input type="email" class="form-control" placeholder="Enter your email">
                </div>
                <div class="col-auto">
                    <button class="btn btn-primary">Κάνε εγγραφή</button>
                </div>
            </form>
        </div>
    </section>


    <section class="py-5 bg-light">
        <div class="container">
          <div class="row align-items-center">
            <div class="col-md-6 mb-4 mb-md-0">
              <img src="/index/partner.jpg" class="img-fluid rounded shadow" alt="Register Shop">
            </div>
            <div class="col-md-6">
              <h2 class="mb-3">Έχεις Κατάστημα;</h2>
              <p class="lead">Γίνε μέλος της πλατφόρμας μας και παρουσίασε την επιχείρησή σου σε χιλιάδες πιθανούς πελάτες. Εύκολη εγγραφή και εξαιρετική προβολή!

              </p>
              <ul class="list-unstyled mb-4">
                <li>✅ Καταχώρισε το κατάστημά σου στην πόλη και την περιοχή σου</li>
                <li>✅ Ανέβασε φωτογραφίες, περιγραφή και στοιχεία επικοινωνίας</li>
                <li>✅ Δέξου κρατήσεις και αξιολογήσεις απευθείας από τους χρήστες</li>
              </ul>
              <a href="application.html" class="btn btn-primary btn-lg">Κάνε αίτηση </a>
            </div>
          </div>
        </div>
      </section>
      


    <footer class="text-center">
        <p>&copy; 2025 MyShop. All rights reserved. <a href="privacy.html">Privacy Policy</a> | <a href="terms.html">Terms of Service</a></p>
        <div class="social-icons">
            <a href="https://facebook.com" target="_blank" aria-label="Facebook"><i class="bi bi-facebook"></i></a>
            <a href="https://twitter.com" target="_blank" aria-label="Twitter"><i class="bi bi-twitter"></i></a>
            <a href="https://instagram.com" target="_blank" aria-label="Instagram"><i class="bi bi-instagram"></i></a>
            <a href="https://linkedin.com" target="_blank" aria-label="LinkedIn"><i class="bi bi-linkedin"></i></a>
        </div>
    </footer>
    <div class="custom-cursor-light"></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <script src="/authUtils.js"></script>
    <script src="script.js"></script>
    <script src="components/customAlert.js"></script>
    <script type="module">
    import { updateNavbarOnLogin, applyNavbarStateFromSession, handleLogout } from '/authUtils.js';

    document.addEventListener('DOMContentLoaded', async () => {
        try {
            // Έλεγχος αν ο χρήστης είναι συνδεδεμένος
            const response = await fetch('/api/check-auth', { credentials: 'include' });
            const authData = await response.json();

            if (authData.isAuthenticated) {
                // Ενημέρωση του navbar
                await updateNavbarOnLogin();
            } else {
                // Αν ο χρήστης δεν είναι συνδεδεμένος, καθαρισμός του UI
                applyNavbarStateFromSession();
            }
        } catch (error) {
            console.error('Error during authentication check:', error);
        }
    });

    // Προσθήκη event listener στο κουμπί Logout
    document.getElementById('logoutBtn').addEventListener('click', handleLogout);

    

    // IDs για τις πόλεις (βάλε τα σωστά cityId από τη βάση σου)
const ATHENS_CITY_ID = '67ef5b2f15e5f9c8a42e2e91';
const THESS_CITY_ID = '67ef5b2215e5f9c8a42e2e8e';

document.getElementById('viewAllAthensBtn').addEventListener('click', () => {
    window.location.href = `searchShops.html?cityId=${ATHENS_CITY_ID}`;
});

document.getElementById('viewAllThessBtn').addEventListener('click', () => {
    window.location.href = `searchShops.html?cityId=${THESS_CITY_ID}`;
});

// --- ΝΕΟ: City & Category Dropdown Logic ---
const cityDropdown = document.getElementById('cityDropdown');
const categoryDropdown = document.getElementById('categoryDropdown');
const viewAllBtn = document.getElementById('viewAllBtn');

let cityImages = {};
let categoryImages = {};

// Φόρτωσε πόλεις με εικόνες
async function loadCities() {
  try {
    const res = await fetch('/city');
    const cities = await res.json();
    cityDropdown.innerHTML = '<option value="">-- πόλη --</option>';
    cityImages = {};
    cities.forEach(city => {
      cityImages[city._id] = city.image || '/images/default-city.jpg';
      const opt = document.createElement('option');
      opt.value = city._id;
      opt.textContent = city.name;
      // Add image as background for custom dropdown styling
      opt.style.backgroundImage = `url('${cityImages[city._id]}')`;
      opt.style.backgroundRepeat = 'no-repeat';
      opt.style.backgroundSize = '1.5em 1.5em';
      opt.style.backgroundPosition = '0.4em center';
      opt.style.paddingLeft = '2.2em';
      cityDropdown.appendChild(opt);
    });
  } catch {}
}

// Φόρτωσε κατηγορίες με εικόνες
async function loadCategories() {
  try {
    const res = await fetch('/category');
    let categories = await res.json();
    if (categories.categories) categories = categories.categories;
    categoryDropdown.innerHTML = '<option value="">-- κατηγορία --</option>';
    categoryImages = {};
    categories.forEach(cat => {
      categoryImages[cat._id] = cat.image || '/images/default-placeholder.jpg';
      const opt = document.createElement('option');
      opt.value = cat._id;
      opt.textContent = cat.name;
      // Add image as background for custom dropdown styling
      opt.style.backgroundImage = `url('${categoryImages[cat._id]}')`;
      opt.style.backgroundRepeat = 'no-repeat';
      opt.style.backgroundSize = '1.5em 1.5em';
      opt.style.backgroundPosition = '0.4em center';
      opt.style.paddingLeft = '2.2em';
      categoryDropdown.appendChild(opt);
    });
    categoryDropdown.style.display = '';
  } catch {}
}

// Εμφάνισε το εικονίδιο της πόλης όταν αλλάζει επιλογή
cityDropdown.addEventListener('change', function() {
  const cityId = this.value;
  const icon = document.getElementById('cityIconPreview');
  if (cityId && cityImages[cityId]) {
    icon.innerHTML = `<img src="${cityImages[cityId]}" alt="" style="width:48px;height:48px;object-fit:cover;border-radius:50%;border:2.5px solid #fff;box-shadow:0 2px 8px #0002;">`;
  } else {
    icon.innerHTML = '';
  }
  const categoryId = categoryDropdown.value;
  if (cityId) {
    viewAllBtn.style.display = '';
    viewAllBtn.textContent = 'View All Categories';
    categoryDropdown.value = '';
    loadCategories();
  } else {
    viewAllBtn.style.display = 'none';
    categoryDropdown.style.display = 'none';
  }
});

// Εμφάνισε το εικονίδιο της κατηγορίας όταν αλλάζει επιλογή
categoryDropdown.addEventListener('change', function() {
  const catId = this.value;
  const icon = document.getElementById('categoryIconPreview');
  if (catId && categoryImages[catId]) {
    icon.innerHTML = `<img src="${categoryImages[catId]}" alt="" style="width:40px;height:40px;object-fit:cover;border-radius:50%;border:2.5px solid #fff;box-shadow:0 2px 8px #0002;">`;
  } else {
    icon.innerHTML = '';
  }
  if (this.value) {
    viewAllBtn.style.display = '';
    viewAllBtn.textContent = 'View Shops in Category';
  } else {
    viewAllBtn.textContent = 'View All Categories';
  }
});

viewAllBtn.addEventListener('click', function() {
  const cityId = cityDropdown.value;
  const categoryId = categoryDropdown.value;
  if (cityId && categoryId) {
    window.location.href = `searchShops.html?cityId=${cityId}&categoryId=${categoryId}`;
  } else if (cityId) {
    window.location.href = `searchShops.html?cityId=${cityId}`;
  }
});

// Αρχικό load
document.addEventListener('DOMContentLoaded', loadCities);

// --- City Explore Section: Full Hero + Carousel ---
let currentCityIdx = 0;
let citiesData = [];

function renderMainCityHero(idx) {
  const hero = document.getElementById('mainCityHero');
  if (!hero || !citiesData.length) return;
  const city = citiesData[idx];
  hero.innerHTML = `
    <div style="position:absolute;inset:0;z-index:1;background:linear-gradient(180deg,rgba(20,20,30,0.15) 0%,rgba(20,20,30,0.65) 100%),url('${city.image||'/images/default-city.jpg'}') center center/cover no-repeat;"></div>
    <div style="position:relative;z-index:2;width:100%;height:100%;display:flex;align-items:center;justify-content:center;min-height:420px;">
      <a href="searchShops.html?cityId=${city._id}" style="text-decoration:none;display:flex;align-items:center;justify-content:center;width:100%;height:100%;">
        <h1 style="color:#fff;font-size:4vw;letter-spacing:0.25em;font-weight:800;text-shadow:0 4px 32px #000b;text-align:center;display:inline-block;background:rgba(0,0,0,0.18);padding:0.5em 1.5em;border-radius:18px;cursor:pointer;transition:background 0.18s;">
          ${city.name.toUpperCase()}
        </h1>
      </a>
    </div>
    <button id="cityHeroPrev" aria-label="Previous city" style="position:absolute;left:32px;bottom:32px;z-index:3;background:none;border:2px solid #fff;border-radius:50%;width:54px;height:54px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:2rem;backdrop-filter:blur(4px);opacity:0.85;transition:background 0.2s;"><i class="bi bi-arrow-left"></i></button>
    <button id="cityHeroNext" aria-label="Next city" style="position:absolute;left:104px;bottom:32px;z-index:3;background:none;border:2px solid #fff;border-radius:50%;width:54px;height:54px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:2rem;backdrop-filter:blur(4px);opacity:0.85;transition:background 0.2s;"><i class="bi bi-arrow-right"></i></button>
  `;
  document.getElementById('cityHeroPrev').onclick = () => {
    currentCityIdx = (currentCityIdx - 1 + citiesData.length) % citiesData.length;
    renderMainCityHero(currentCityIdx);
    renderCityCardsCarousel(currentCityIdx);
  };
  document.getElementById('cityHeroNext').onclick = () => {
    currentCityIdx = (currentCityIdx + 1) % citiesData.length;
    renderMainCityHero(currentCityIdx);
    renderCityCardsCarousel(currentCityIdx);
  };
}

function renderCityCardsCarousel(activeIdx) {
  const carousel = document.getElementById('cityCardsCarousel');
  if (!carousel || !citiesData.length) return;
  carousel.innerHTML = '';
  citiesData.forEach((city, idx) => {
    if (idx === activeIdx) return;
    const card = document.createElement('div');
    card.className = 'city-carousel-card';
    card.style = `min-width:220px;max-width:240px;height:140px;border-radius:22px;overflow:hidden;box-shadow:0 4px 24px #0007;position:relative;cursor:pointer;transition:transform 0.18s;background:#181824;`;
    card.innerHTML = `
      <img src="${city.image||'/images/default-city.jpg'}" alt="${city.name}" style="width:100%;height:100%;object-fit:cover;filter:brightness(0.85);">
      <span style="position:absolute;left:0;right:0;bottom:0;padding:12px 18px 10px 18px;color:#fff;font-size:1.15rem;font-weight:700;text-shadow:0 2px 8px #000b;letter-spacing:0.04em;">${city.name.toUpperCase()}</span>
    `;
    card.onclick = () => {
      currentCityIdx = idx;
      renderMainCityHero(currentCityIdx);
      renderCityCardsCarousel(currentCityIdx);
    };
    carousel.appendChild(card);
  });
}

async function loadAndRenderCitiesHero() {
  try {
    const res = await fetch('/city');
    citiesData = await res.json();
    if (!citiesData.length) return;
    currentCityIdx = 0;
    renderMainCityHero(currentCityIdx);
    renderCityCardsCarousel(currentCityIdx);
  } catch {}
}
document.addEventListener('DOMContentLoaded', loadAndRenderCitiesHero);
</script>
</body>
</html>
